riscv64-unknown-elf-gcc -Wall -Werror -O -fno-omit-frame-pointer -ggdb -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -fno-stack-protector -fno-pie -no-pie -c kernel/trap/syscall.c -o kernel/trap/syscall.o
riscv64-unknown-elf-ld -z max-page-size=4096 -T kernel/kernel.ld -o kernel.elf kernel/trampoline.o kernel/boot/entry.o kernel/boot/start.o kernel/main.o kernel/utils/printf.o kernel/utils/uart.o kernel/utils/console.o kernel/mm/kalloc.o kernel/utils/string.o kernel/utils/spinlock.o kernel/utils/sleeplock.o kernel/mm/vm.o kernel/trap/trap.o kernel/trap/kernelvec.o kernel/trap/syscall.o kernel/trap/plic.o kernel/proc/proc.o kernel/proc/swtch.o kernel/proc/proc_test.o kernel/fs/file.o kernel/proc/exec.o kernel/fs/bio.o kernel/fs/virtio_disk.o kernel/fs/fs.o kernel/fs/log.o 
qemu-system-riscv64 -machine virt -bios none -kernel kernel.elf -m 128M -smp 1 -nographic -global virtio-mmio.force-legacy=false -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0
S
B
S
My RISC-V OS Starting...
System initialization complete!
Entering scheduler...
第一个进程初始化，准备切换到用户态...
forkret: enabling interrupts...
forkret: calling fsinit...
forkret: fsinit completed
[DEBUG] exec: oldsz=0, p->sz=0
[DEBUG] exec: before free, oldsz=0, new sz=4000
[DEBUG] exec: after proc_freepagetable

=== RISC-V OS Shell ===
输入 'help' 查看可用命令
输入 'exit' 退出

$ ls
[DEBUG] exec: oldsz=4000, p->sz=4000
[DEBUG] exec: before free, oldsz=4000, new sz=4000
[DEBUG] exec: after proc_freepagetable
FILE 6328 init
FILE 5352 hello
FILE 6296 shell
FILE 5384 myproc
FILE 5432 touch
FILE 5456 delete
FILE 5512 echo
FILE 5456 cat
sched: process running ls
panic: sched: process running
qemu-system-riscv64: terminating on signal 15 from pid 24646 (timeout)
